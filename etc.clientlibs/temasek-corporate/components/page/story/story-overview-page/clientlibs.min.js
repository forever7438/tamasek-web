jQuery(function(d){function I(){var a=d(".image-video-banner-wrapper"),b=a.data("mobileImagePath");b&&a.css("background-image","url('"+b+"')")}function z(){q.not(".slick-initialized").slick(D)}function J(){q.hasClass("slick-initialized")&&q.slick("unslick")}function w(){return{numOfItems:12,totalItems:0,currentlyShowingItems:0,nextShowingItems:0,data:null,loadMore:!0}}function T(){function a(a){k.find(".tags-toggle-btn").addClass("is-active");q.addClass("is-active");k.find(".tags-wrapper--item-list").find("a[data-tag-id\x3d'"+
F.escape(a)+"']").trigger("click");window.localStorage.removeItem("tagId");setTimeout(function(){d("html, body").animate({scrollTop:k.offset().top},300)})}function b(a){setTimeout(function(){B.find("li").find("a[data-category-id\x3d'"+F.escape(a)+"']").trigger("click");window.localStorage.removeItem("categoryId")},100)}var c=window.localStorage.getItem("tagId");c?a(c):(c=window.localStorage.getItem("categoryId"))&&b(c)}function U(){var a=K.safeLocationHash(),b=a.replace("#","");a&&B.find("li").find("a[data-category-id\x3d'"+
F.escape(b)+"']").trigger("click")}function L(a,b){1<a.length?(d(".heading-tab").removeClass("no-tags"),d(".tags-wrapper").show()):(d(".heading-tab").addClass("no-tags"),d(".tags-wrapper").hide());a=x.map(a,function(a){return["a",{"data-tag-id":a.tagId,href:"#"},a.tagTitle]});b=b?["h4",b.charAt(0)+" - "+b.charAt(1)]:["h4",M];x.append(q[0],["div",{"class":"tags-wrapper--item"},b,["div",{"class":"tags-wrapper--item-list"},a]])}function V(a,b){a=a.tagTitle.toUpperCase();b=b.tagTitle.toUpperCase();return a>
b?1:a<b?-1:0}function W(a){481>m&&J();q.empty();"en"===X?h.forEach(Y,function(b){if(b){var c=[];b=b.toUpperCase();var d=b.charCodeAt(0),e=b.charCodeAt(1);h.forEach(a,function(a){var b=a.tagTitle.toUpperCase().charCodeAt(0);d<=b&&b<=e&&c.push(a)});c.sort(V);L(c,b)}}):L(a);481>m&&z();!0===N&&(T(),U(),N=!1)}function E(){var a=[];h.forEach(c.data,function(b){b.tags&&h.forEach(b.tags,function(b){var c=b.tagId;h.some(a,function(a){return a.tagId===c})||a.push(b)})});W(a)}function G(a,b){return h.filter(a,
function(a){return void 0!==a.categoryId&&O.includes(a.categoryId,b)})}function Z(){e.find(".heading-tab a").on("click",function(a){var b=a.currentTarget,p=d(b).data("tab");d(b).parent().addClass("is-active").siblings().removeClass("is-active");e.find(".mobile-heading-tab a").parent().removeClass("is-active");e.find(".mobile-heading-tab a[data-tab\x3d"+p+"]").parent().addClass("is-active");c=w();f=B.find("a.is-active").attr("data-category-id");c.data=l.articles;"all"!==f&&(g=G(c.data,f),c.data=g);
"articles"===p?(g=h.filter(c.data,function(a){return!a.videoType}),c.data=g):"videos"===p&&(g=h.filter(c.data,function(a){return a.videoType}),c.data=g);v(!0);E();a.stopPropagation();a.preventDefault()});e.find(".mobile-heading-tab a").on("click",function(a){var b=a.currentTarget;d(b).parent().siblings().removeClass("is-active");d(b).parent().toggleClass("is-active");b=d(b).parent().hasClass("is-active")?d(b).attr("data-tab"):"all";e.find(".heading-tab a").parent().removeClass("is-active");e.find(".heading-tab a[data-tab\x3d"+
b+"]").parent().addClass("is-active");c=w();f=B.find("a.is-active").attr("data-category-id");c.data=l.articles;"all"!==f&&(g=G(c.data,f),c.data=g);"articles"===b?(g=h.filter(c.data,function(a){return!a.videoType}),c.data=g):"videos"===b&&(g=h.filter(c.data,function(a){return a.videoType}),c.data=g);v(!0);E();a.stopPropagation();a.preventDefault()})}function aa(a,b,c,d,e){var p="",A="featured-story";return x.map(a,function(a){var g=!0;var f=[1,6,11,16];var u=16;2E3<m&&(f=[1,7,13,19,25],u=25);1600>=
m&&(f=[1,5,9],u=9);1024>=m&&(f=[1,4],u=4);640>=m&&(f=[]);h.includes(f,C)&&(g=!1);C=C===u?1:C+1;f=g;g=a.smallImageSrc&&f?a.smallImageSrc:a.largeImageSrc?a.largeImageSrc:"";a.description||(a.description="");p=a.featured?a.videoType?d:c:A="";f=f?"":"size-large";u=a.videoType?"video-story":"";var l="";0<K.escapeHtml(a.description).length&&(l="has-desc");f=["story-item",l,f,u,A];u=p;var k=["h3",a.title];l=["div",{"class":"item-body"},["div",{"class":"type-icon"}]];e&&l.push(["span",{"class":"article-category"},
a.category]);l.push(k);k={"class":"item-media"};g&&(k.style="background-image:url("+g+")");g=["article",{"class":f.join(" ")},["div",{"class":"item-label"},u],["a",{href:a.link}],["div",k],l];if(a.videoLength||a.readingTime){var n;a.videoType&&a.videoLength?n=a.videoLength:!a.videoType&&a.readingTime&&(n=a.readingTime+" "+b);g.push(["div",{"class":"time-icon"},n])}0<f.indexOf("has-desc")&&g.push(["div",{"class":"story-listing-description"},a.description]);return g})}function ba(a){var b=e.find(".story-listing-wrapper--content"),
c=e.find(".story-listing-wrapper").data("readtime-suffix"),f=e.find(".story-listing-wrapper").data("featured-article-label"),g=e.find(".story-listing-wrapper").data("featured-video-label"),h=e.find(".story-listing-wrapper").data("showcategory");x.append(b[0],aa(a,c,f,g,h));setTimeout(function(){b.find("article").each(function(a,b){d(b).addClass("visible")})},300)}function v(a){if(c.data){a&&(C=1,n.find(".story-listing-wrapper--content").empty());c.totalItems=c.data.length;c.currentlyShowingItems+
c.numOfItems<c.totalItems?c.nextShowingItems=c.currentlyShowingItems+c.numOfItems:(c.nextShowingItems=c.totalItems,c.loadMore=!1);a=[];for(var b=c.currentlyShowingItems;b<c.nextShowingItems;)a.push(c.data[b]),b+=1;ba(a);c.currentlyShowingItems=c.nextShowingItems}}function P(a){y.slick("unslick");y.empty();if(0===a.length)e.find(".series-carousel-holder").addClass("hide");else{e.find(".series-carousel-holder").removeClass("hide");a=x.map(a,function(a){a.description||(a.description="");return["div",
{"class":"series-wrapper--carousel-item"},["a",{href:a.link},["div",{"class":"item-header"},["img",{src:a.smallImageSrc?a.smallImageSrc:"/etc.clientlibs/temasek-corporate/clientlibs/base/resources/images/placeholder-dummy.jpg",alt:""}],["h4",{"class":"item-heading"},a.title]],["div",{"class":"item-text"},a.description]]]});x.append(y[0],a);y.not(".slick-initialized").slick(D);a=d(".filter-wrapper--list a.is-active");var b=d(".filter-wrapper--list a.is-active strong").text();d(".series-wrapper h3 span").remove();
"all"!==a.data("category-id")&&x.append(d(".series-wrapper h3")[0],["span"," - "+b])}}function ca(){var a;"all"===f?a=l.series:l.series&&(a=h.filter(l.series,function(a){return O.includes(a.categoryId,f)}));a&&P(a)}function da(){n.addClass("loadingData");var a=n.data("resource");jQuery.ajax("/bin/public/temasek-corporate/storieslist.json",{data:{resource:a},dataType:"json"}).done(function(a){if(a){l=a;c.data=l.articles;v();E();l.series&&P(l.series);Z();a=h.every(l.articles,function(a){return a.videoType});
var b=h.every(l.articles,function(a){return!a.videoType});a||b?(d(".story-listing-header .heading-tab").hide(),d(".story-listing-header .mobile-heading-tab").hide(),d(".story-listing-header .heading-articles").addClass("no-filter")):(d(".story-listing-header .heading-tab").show(),d(".story-listing-header .mobile-heading-tab").show(),d(".story-listing-header .heading-articles").removeClass("no-filter"))}n.removeClass("loadingData")})}function Q(){if(!1!==c.loadMore){var a=r.height(),b=r.scrollTop(),
e=d(document).height(),f=d(".page footer").height()+100;a+b>=e-f&&v()}}function ea(){var a=[],b=[];k.find(".tags-wrapper--item .is-active").each(function(b,c){a.push(d(c).data("tagId"))});"all"===f&&(g=l.articles);c=w();0<a.length?(g&&h.forEach(g,function(c){c.tags&&h.forEach(c.tags,function(d){h.includes(a,d.tagId)&&(h.some(b,function(a){return a.index===c.index})||b.push(c))})}),c.data=b):c.data=g;var p=e.find(".heading-tab li.is-active").find("a").attr("data-tab");c.data&&("articles"===p?c.data=
h.filter(c.data,function(a){return!a.videoType}):"videos"===p&&(c.data=h.filter(c.data,function(a){return a.videoType})));v(!0)}function R(){H&&(H=!1,c=w(),c.data="all"!==f?g:l.articles,v(!0),e.find("#storySearchTxt").val(""),q.removeClass("is-active"),n.find(".heading-search-resutls").hide(),k.find(".tags-wrapper--item .is-active").removeClass("is-active"),e.find(".filter-wrapper, .tags-wrapper, .heading-articles").show(),e.find(".series-carousel-holder").removeClass("hide"),e.find(".heading-tab").removeClass("hide"))}
function S(){var a,b=0,c=0,e=d("header");r.on("scroll",function(d){640<m?(d.stopPropagation(),d.preventDefault()):(a=r.scrollTop(),300<a?(t.addClass("search-sticky"),c=b-a,0<c?t.css("top",e.height()+1):0>=c&&t.css("top","0px"),b=a):t.removeClass("search-sticky"))})}var h=blacksunplc.arrays,O=blacksunplc.strings,F=blacksunplc.css,K=blacksunplc.security,x=blacksunplc.jsonml,y=d("#seriesCarousel"),e=d(".stories-page-wrapper"),B=e.find(".filter-wrapper"),k=e.find(".tags-wrapper"),q=k.find(".tags-toggle-content"),
n=d("#storyListing"),fa=String(n.data("noSearchResults")),r=d(window),X=d("body").data("languageName"),m=r.width(),C=1,N=!0;841>m&&I();var D={infinite:!0,slidesToShow:4,slidesToScroll:1,autoplay:!0,autoplaySpeed:5E3,dots:!0,adaptiveHeight:!0,responsive:[{breakpoint:1599,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:769,settings:{slidesToShow:2,slidesToScroll:1,arrows:!1}},{breakpoint:481,settings:{slidesToShow:1,slidesToScroll:1,arrows:!0,autoplay:!1}}]};0<y.length&&y.not(".slick-initialized").slick(D);
481>m&&q.not(".slick-initialized").slick(D);k.on("click",".tags-toggle-btn",function(a){d(a.currentTarget).toggleClass("is-active");q.toggleClass("is-active")});var l=null,g=null,f="all",c=w(),M=k.data("chineseTagsRange");if(0<k.length){var Y=k.data("tags").split(";");M=k.data("chineseTagsRange")}0<n.length&&da();B.on("click","li a",function(a){a.preventDefault();var b=d(a.currentTarget),k=String(b.data("categoryId")),A=b.find("strong").text();640<m&&f===k?a.stopPropagation():(c=w(),f=k,c.data=l.articles,
641>m?b.hasClass("is-active")?(b.removeClass("is-active"),b.parents("ul").find("li").first().find("a").addClass("is-active"),f="all",A="All"):(b.parent().siblings().find("a").removeClass("is-active"),b.addClass("is-active")):(b.parent().siblings().find("a").removeClass("is-active"),b.addClass("is-active")),"all"!==f&&(g=G(c.data,f),c.data=g),e.find(".heading-tab li").removeClass("is-active"),e.find(".heading-tab li").eq(0).addClass("is-active"),e.find(".mobile-heading-tab li").removeClass("is-active"),
v(!0),ca(),E(),"all"===f?(n.find(".heading-articles").css({display:"none"}).find("h3").text(d(".heading-articles h3").attr("data-string-all")),history.pushState(null,""," ")):(n.find(".heading-articles").css({display:"flex"}).find("h3").text(A+d(".heading-articles").data("articles")),history.pushState(null,"","#"+k)),a=h.every(c.data,function(a){return a.videoType}),b=h.every(c.data,function(a){return!a.videoType}),a||b?(d(".story-listing-header .heading-tab").hide(),d(".story-listing-header .mobile-heading-tab").hide(),
d(".story-listing-header .heading-articles").addClass("no-filter")):(d(".story-listing-header .heading-tab").show(),d(".story-listing-header .mobile-heading-tab").show(),d(".story-listing-header .heading-articles").removeClass("no-filter")))});k.on("click",".tags-wrapper--item-list a",function(a){a.preventDefault();d(a.currentTarget).toggleClass("is-active");ea()});var H=!1;n.find(".heading-search-resutls").on("click","button",R);e.on("click","#storySearchBtn",function(a){a.preventDefault();var b=
e.find("#storySearchTxt").val();b=b.trim();b=b.replace(/\s+/g," ");if(""===b)R(),a.stopPropagation();else{n.find(".heading-search-resutls").show().find(".search-text span").text(b);H=!0;var f=b.split(" ");c=w();var g=[];h.forEach(l.articles,function(a){var b=a.title.toLowerCase();h.forEach(f,function(c){var e=(new RegExp(c)).test(b);(e="zh"===d("html").attr("lang")?(new RegExp(encodeURIComponent(c))).test(encodeURIComponent(b)):(new RegExp("\\b"+c.toLowerCase()+"\\b")).test(b))&&(h.some(g,function(b){return b.index===
a.index})||g.push(a))})});c.data=g;v(!0);0===g.length&&e.find(".story-listing-wrapper--content").append(fa);e.find(".filter-wrapper, .tags-wrapper, .heading-articles").hide();e.find(".series-carousel-holder").addClass("hide");e.find(".heading-tab").addClass("hide");e.find(".heading-tab li").removeClass("is-active");e.find(".heading-tab li").eq(0).addClass("is-active");a=e.offset().top;b=e.find(".story-listing-wrapper").offset().top;var k=d("header").outerHeight(!0),m=d(".search-and-subscribe-wrapper").outerHeight(!0);
a=640>=d(window).width()?b-k-m:d(window).scrollTop()>a?a-k:a;d("html, body").animate({scrollTop:a})}});e.on("keypress","#storySearchTxt",function(a){13===a.keyCode&&e.find("#storySearchBtn").trigger("click")});r.on("scroll",Q);r.on("resize",function(){Q();m=r.width();481>m?z():setTimeout(J,100)});var ha=d(".sectionbanner .image-video-banner-text").text(),t=d(".search-and-subscribe-wrapper");0<t.length&&(t.find(".heading-wrapper").text(ha),t.on("click","#searchToggleBtn",function(a){a=d(a.currentTarget);
t.find(".heading-wrapper, .btn-subscribe").toggle();t.find(".search-wrapper").toggleClass("is-active");a.toggleClass("is-active")}),641>m&&S(),r.on("resize",function(){641>m&&S()}))});(function(){jQuery(document).on("ajaxComplete",function(d,I,z){z&&-1!==z.url.indexOf("/bin/public/temasek-commons/twitterfeedlist")&&ObjTwitter.initialize()})})();